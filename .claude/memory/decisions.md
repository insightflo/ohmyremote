# Architecture Decisions

## ADR-001: monorepo 구조 사용

**날짜**: 2026-02-28
**상태**: 승인됨

**컨텍스트**:
- 다중 앱 구조 (Telegram 봇, API 서버, 웹 대시보드)
- 공유 타입 및 유틸리티 필요
- 단일 프로젝트에서 모든 앱 관리 용이성

**결정**:
pnpm workspaces를 사용한 monorepo 구조 사용

**아키텍처**:
```
pnpm monorepo
├── apps/          # 애플리케이션
└── packages/      # 패키지
```

**결과**:
- 코드 재사용성 증가
- 공통 의존성 관리 용이
- 일관된 빌드 프로세스
- 유지보수성 개선

---

## ADR-002: Fastify 선택

**날짜**: 2026-02-28
**상태**: 승인됨

**컨텍스트**:
- Fastify 대비 비교 대상: Express, Koa
- 필요한 기능: 스트리밍, 타이머, 인터셉터, 인증
- 성능 중요성

**결정**:
Fastify (v5) 사용

**대안 검토**:
- Express: 느림, 콜백 지옥
- Koa: Express와 비슷
- Fastify: Hapi 기반, 빠름, 내장 트랜스폼 지원

**결과**:
- 빠른 응답 속도
- 내장 타이머 및 인터셉터
- 스트리밍 지원 우수
- 스키마 검증 (Zod) 통합 용이

---

## ADR-003: grammY 선택

**날짜**: 2026-02-28
**상태**: 승인됨

**컨텍스트**:
- 봇 기능 복잡도 증가 (세션 관리, 스트리밍, 인라인 키보드)
- TypeScript 지원 필요
- 프레임워크의 친절한 문서 및 커뮤니티

**결정**:
grammY 사용

**대안 검토**:
- telegraf: 버전 호환성 이슈
- node-telegram-bot-api: 문서가 없음
- grammY: TypeScript 1급 지원, 최신 Telegram Bot API 지원

**결과**:
- 훌륭한 TypeScript 지원
- 인라인 키보드, 스트리밍 지원 우수
- 테스트 지원 (메모리 봇)
- 최신 API 적용 가능

---

## ADR-004: Drizzle ORM 사용

**날짜**: 2026-02-28
**상태**: 승인됨

**컨텍스트**:
- Type-safe 데이터베이스 접근 필요
- SQLite 사용 (싱글 사용자용)
- 마이그레이션 시스템 필요

**결정**:
Drizzle ORM 사용

**대안 검토**:
- Prisma: 오버헤드 큼, 단일 사용자에 과함
- typeorm: 비동기 래퍼 느림
- Drizzle: TypeScript 친화적, 가벼움, 마이그레이션 지원

**결과**:
- 타입 안전한 쿼리
- 가벼운 패키지 사이즈
- 좋은 마이그레이션 도구
- 직관적인 API
